---
description: Database and Prisma Migration Standards
globs: prisma/**/*, package.json
---

# Database & Migrations

- **NEVER** use `prisma db push` in production. It causes data loss/drift.
- **ALWAYS** use `prisma migrate dev` locally to create migration files.
- **DEPLOYMENT**: `postbuild` script must run `prisma migrate deploy`.

## Connection Standards (Supabase)
- **Transaction Pooler (Port 6543)**: Use for `DATABASE_URL` (App Runtime).
- **Session Pooler (Port 5432)**: Use for `DIRECT_URL` (Migrations).
- **Credentials**: User must be `postgres.[project-ref]`.
